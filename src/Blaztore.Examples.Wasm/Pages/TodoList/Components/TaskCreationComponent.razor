@using Blaztore.Components
@using Blaztore.Gateways
@inherits Blaztore.Components.BaseStateComponent

@if (!State.IsAddingTask)
{
    <button 
        onclick="@(() => Gateway.Dispatch(new TaskCreationState.StartAddingNewTask()))">
        New task
    </button>
}
else
{
    <div>
        <input
            value="@State.NewTaskDescription"
            @oninput="@(args => Gateway.Dispatch(new TaskCreationState.DefineNewDescription((string?)args.Value ?? string.Empty)))"/>

        <button
            disabled="@(string.IsNullOrWhiteSpace(State.NewTaskDescription))"
            @onclick="@(_ => Gateway.Dispatch(new TaskCreationState.ExecuteTaskCreation()))">
            Validate
        </button>
    </div>
}

@inject IGlobalStateReduxGateway<TaskCreationState> Gateway

@code {
    private TaskCreationState State => Gateway.SubscribeToState(this);

    protected override Task OnAfterInitialRenderAsync() =>
        Gateway.Dispatch(new TaskCreationState.Load());
}